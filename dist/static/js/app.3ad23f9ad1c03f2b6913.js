webpackJsonp([1],{0:function(e,t){},1:function(e,t){},2:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=n("xd7I"),o=n("3cXf"),a=n.n(o),r=n("ZLEe"),i=n.n(r),s=n("aA9S"),c=n.n(s),u=n("hRKE"),f=n.n(u),d=n("xXAf"),p={name:"Index",data:function(){return{fullscreenLoading:!1,imFile:"",outFile:"",errorDialog:!1,errorMsg:"",excelData:[{xm:"张三",xb:"男",csny:"1980-02",sfzh:"330522198002011102",sjhm:"13111112222"},{xm:"李四",xb:"女",csny:"1963-02",sfzh:"330522198002011102",sjhm:"13111112222"}],tabH:[{xm:"姓名",xb:"性别",csny:"出生年月",sfzh:"身份证号",sjhm:"手机号码",xj:"星级",stdx:"十条底线",xfzs:"先锋指数",pjjg:"评价结果"}]}},mounted:function(){this.imFile=document.getElementById("imFile"),this.outFile=document.getElementById("downlink")},methods:{uploadFile:function(){this.imFile.click()},downloadFile:function(e){var t=this.tabH[0],n=[];n=(n=n.concat(t)).concat(e),console.log(n);var l=new Date,o=l.getFullYear(),a=l.getMonth()+1,r=l.getDate();this.downloadExl(n,o+"-"+a+"-"+r)},importFile:function(){this.fullscreenLoading=!0;var e=this.imFile;if(e.files){var t=e.files[0],n=new FileReader,l=this;n.onload=function(e){var t=e.target.result;l.rABS?l.wb=d.read(btoa(this.fixdata(t)),{type:"base64"}):l.wb=d.read(t,{type:"binary"});var n=d.utils.sheet_to_json(l.wb.Sheets[l.wb.SheetNames[0]]);console.log(void 0===n?"undefined":f()(n)),l.dealFile(l.analyzeData(n))},this.rABS?n.readAsArrayBuffer(t):n.readAsBinaryString(t)}else this.fullscreenLoading=!1},downloadExl:function(e,t,n){var l=this,o=[];for(var a in e[0])o.push(a);console.info("keyMap",o,e);var r=[];e.map(function(e,t){return o.map(function(n,o){return c()({},{v:e[n],position:(o>25?l.getCharCol(o):String.fromCharCode(65+o))+(t+1)})})}).reduce(function(e,t){return e.concat(t)}).forEach(function(e){r[e.position]={v:e.v}});var s=i()(r),u={SheetNames:["mySheet"],Sheets:{mySheet:c()({},r,{"!ref":s[0]+":"+s[s.length-1]})}},f=new Blob([this.s2ab(d.write(u,{bookType:void 0===n?"xlsx":n,bookSST:!1,type:"binary"}))],{type:""}),p=URL.createObjectURL(f);this.outFile.download=t+".xlsx",this.outFile.href=p,this.outFile.click(),setTimeout(function(){URL.revokeObjectURL(f)},100)},analyzeData:function(e){return e},dealFile:function(e){console.log(e);var t=JSON.parse(a()(this.tabH[0]));for(var n in t){t[t[n]]=n,delete t[n]}for(var l=0;l<e.length;l++)for(var o in e[l]){var r=t[o];r&&(e[l][r]=e[l][o],delete e[l][o])}console.log(e),this.imFile.value="",this.fullscreenLoading=!1,e.length<=0?(this.errorDialog=!0,this.errorMsg="请导入正确信息"):this.excelData=this.excelData.concat(e)},s2ab:function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),l=0;l!==e.length;++l)n[l]=255&e.charCodeAt(l);return t},getCharCol:function(e){for(var t="",n=0;e>0;)n=e%26+1,t=String.fromCharCode(n+64)+t,e=(e-n)/26;return t},fixdata:function(e){for(var t="",n=0,l=10240;n<e.byteLength/l;++n)t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(n*l,n*l+l)));return t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(n*l)))}}},h={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"index",attrs:{"element-loading-text":"拼命加载中..."}},[n("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"imFile",accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},on:{change:function(t){return e.importFile(this)}}}),e._v(" "),n("a",{attrs:{id:"downlink"}}),e._v(" "),n("el-button",{staticClass:"button",on:{click:function(t){return e.uploadFile()}}},[e._v("导入")]),e._v(" "),n("el-button",{staticClass:"button",on:{click:function(t){return e.downloadFile(e.excelData)}}},[e._v("导出")]),e._v(" "),n("span",[e._v("导入要有固定格式，格式参照导出，且表头禁止修改")]),e._v(" "),n("el-dialog",{attrs:{title:"提示",size:"tiny"},model:{value:e.errorDialog,callback:function(t){e.errorDialog=t},expression:"errorDialog"}},[n("span",[e._v(e._s(e.errorMsg))]),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.errorDialog=!1}}},[e._v("确认")])],1)]),e._v(" "),n("el-table",{staticClass:"tabl",attrs:{data:e.excelData,"tooltip-effect":"dark"}},[n("el-table-column",{attrs:{label:"姓名",prop:"xm"}}),e._v(" "),n("el-table-column",{attrs:{label:"性别",prop:"xb"}}),e._v(" "),n("el-table-column",{attrs:{label:"出生年月",prop:"csny"}}),e._v(" "),n("el-table-column",{attrs:{label:"身份证号",prop:"sfzh"}}),e._v(" "),n("el-table-column",{attrs:{label:"手机号码",prop:"sjhm"}})],1)],1)},staticRenderFns:[]};var m=n("C7Lr")(p,h,!1,function(e){n("zPPL")},null,null).exports,v=n("7LQH"),g=n("C7Lr")(null,null,!1,null,null,null).exports;l.default.use(v.a);var b=new v.a({routes:[{path:"/",name:"HelloWorld",component:g}]}),x=n("NxjZ"),y=n.n(x);n("zlkP");l.default.use(y.a),l.default.config.productionTip=!1,new l.default({el:"#app",router:b,components:{App:m},template:"<App/>"})},zPPL:function(e,t){},zlkP:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.3ad23f9ad1c03f2b6913.js.map